
name: Build Windows

on:
  workflow_dispatch:
  pull_request:
    

jobs:
  build:
    runs-on: windows-latest

    steps:
      - uses: actions/checkout@v2
      
      - name: Setup MSYS2
        uses: msys2/setup-msys2@v2
        
      - name: Setup Rust
        shell: msys2 {0}
        run: pacman -Syy --noconfirm mingw-w64-x86_64-rust mingw-w64-x86_64-gtk4 mingw-w64-x86_64-pkgconf mingw-w64-x86_64-gcc
      
      #- name: Setup Rust
      #  uses: ATiltedTree/setup-rust@v1.0.5
      #  with:
      #    rust-version: stable-gnu
          
      - shell: msys2 {0}
        run: env

      #- name: Set default toolchain
      #  shell: msys2 {0}
      #  run: "C:\\Users\\runneradmin\\.cargo\\bin\\rustup.exe default stable-gnu"

      - name: Show version
        shell: msys2 {0}
        run: "cargo --version"
       #   | "C:\\Users\\runneradmin\\.cargo\\bin\\rustup.exe toolchain list"
       
      - name: Build
        shell: msys2 {0}
        run: cargo build
        
      - shell: msys2 {0}
        run: tree target
        
      #- name: Upload Binary
      #  uses: actions/upload-artifact@v2.3.1
      #  with:
      #    name: Binary
      #    path: 
